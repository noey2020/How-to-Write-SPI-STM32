# How-to-Write-SPI-STM32

SPI, Synchronous Serial Communications       July 20, 2020

I appreciate comments. Shoot me an email at noel_s_cruz@yahoo.com!

Hire me!

Electronic circuits contain chips which communicate with each other so it can work in 
tandem to accomplish tasks. There was a time when chips only had 4 pins and parallel mode
would completely use up those precious pins so serial was a good idea. Chips have grown 
in size, complexity, and packaging thus giving us more pins. Nevertheless, even with more
pins available, the appetite is insatiable.

By sending bits one at a time, that is called serial. Using a clock signal to synchronize
events is called synchronous. SPI or Serial Peripheral Interface is a classic example of 
synchronous serial communications. It uses 4-wires and can do full-duplex.

The interface was developed by Motorola in 1979 and a de facto standard. Typical
applications include digital cameras, cards, and liquid crystal displays. SPI devices 
communicate in full duplex mode using a master-slave architecture with a single master.

SPI is simple, low power requirement, and supports high throughput. Single master
initiates and controls all communications. An SPI interface consists of four lines:
master-in-slave-out line (MISO), master-out-slave-in line (MOSI), serial clock line
(SCLK), and an active-low slave select line (SS).

When the master wishes to exchange data with a particular slave, it pulls down the
corresponding select slave line (SSx). The master generates clock pulses to synchronize 
the data transmission on the MISO and MOSI lines. Data exchange can happen in both 
directions simultaneously, and this is called full duplex. As noted above, there is a 
dedicated slave select line for each slave device. The master selects the target slave
device by pulling the corresponding SS line to a low voltage prior to data transfer. The
selected slave device then listens for the clock and MOSI signals.

It is a synchronous protocol, different from asynchronous. SPI devices must exchange data
at the same speed.

The master and a slave perform data exchange at synchronized steps according to the clock
signal generated by the master.

- When a bit is shifted out from the data register to the output line in each clock
  period, a new bit is shifted into this register from the input line in the same clock
  period.
- When one device writes a bit to the data line at the rising or falling edge of the 
  clock, the other device then reads the bit at the opposite edge of the same clock.
- The data transfer is usually a byte or halfword(16 bits).

This is best visualized looking at the timing or clocking diagram.

Communication from the master and a slave and vice versa are always taking place 
concurrently. In each communication link (either MISO or MOSI), each device sends out a
data item and the same time receives a new data item. No devices can just be a 
transmitter or a receiver.

i2c, usart, usb, external character lcd hd44780, ST7735r spi graphic lcd, kentec
parallel & spi lcd, bluetooth, wifi, iot.
I included some posts for reference.

https://github.com/noey2020/How-to-Write-Multitasking-STM32

https://github.com/noey2020/How-to-Generate-Triangular-Wave-STM32-DAC

https://github.com/noey2020/How-to-Generate-Sine-Table-LUT

https://github.com/noey2020/How-to-Illustrate-Multiple-Exceptions-

https://github.com/noey2020/How-to-Blink-LED-using-Standard-Peripheral-Library

I appreciate comments. Shoot me an email at noel_s_cruz@yahoo.com!

Hire me!

Have fun and happy coding!
